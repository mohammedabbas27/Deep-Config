<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Geb Config Â© 2018 Xmplar.in All right reserved</title>
    <link rel = "stylesheet"
        type = "text/css"
        href = "style.css" />

</head>

<body>
    <div class="head">
            <h2>GEB Config</h2>
            <div class="nav">
                    <button class= "button" id = "but3"><a href="./index1.html">Build-Config</a></button>
                    <button class= "but1" id= "but2"><a href="./index2.html">Schedule</a></button>
                    <button class= "button" id = "but1"><a class = "link1" href="./index.html">Home</a></button>
            </div>
    </div>
    <div class="container-fluid">
        <div class="container">
            <input type="submit" name="" id="reportPathButton" class="button rpBut" value="Jar's Path"><br><br>
            <input type="text" name="" id="jarName" class="inputFiled" placeholder="Name of Jar File Ex: Abc.jar"><br><br>
            <input type="text" name="" id="testCaseName" class="inputFiled" placeholder="Name of Test file Ex:com.xmplar.dcf...."><br><br>
            <input type="text" name="" id="taskName" class="inputFiled" placeholder="Name of Scheduled Task"><br><br>
            <input type="submit" name="" id="configPathButton" class="button rpBut" value="Select Config File"><br><br>
            <input type="text" name="" id="time" class="inputFiled" placeholder="Scheduled Time Ex: 17:24:11"><br><br>
            <select id ="freq">
                <option value="">Select Frequency of Execution</option>
                <option value="ONCE">Once</option>
                <option value="DAILY">Daily</option>
              </select>
            <input type="submit" name="" id="scheduleButton" class="button" value="Submit">

        </div>
    </div>
</body>
<script>
    // const bcrypt = require('bcrypt');
    // const saltRounds = 10;

    // Command to Create a scheduled task from command line:schtasks /Create /tn "mytask5" /sc ONCE /st 17:49:00 /tr "C:\Users\Xmplar\Desktop\UnitTestCases.bat"
    function handleClick(event){
        console.log(event.target)
        var element = event.target.firstChild;
        element.click();
    }
    document.querySelector('#but1').addEventListener('click',function(event){
        handleClick(event)
    });
    document.querySelector('#but2').addEventListener('click',function(event){
        handleClick(event)
    });
    document.querySelector('#but3').addEventListener('click',function(event){
        handleClick(event)
    });
    var fs = require('fs');
    // Or with ECMAScript 6
    var app = require('electron').remote;
    var dialog = app.dialog;
    // var dialogs = require('dialogs')
    var fileName = ""

    function extractFileName() {

    }

    function writeToFile(filename, con) {
        // let con = "\r\nHi there"

        // con = con +"\r\n"
        fs.writeFile(filename, con, (err) => {
        });

    }

    var name;
    var emailAddress;
    var password;
    var toSize;
    var toList = [];
    var ccSize;
    var ccList = [];
    var reportSize;
    var reportList = [];
    var dir1 = "";
    var dir2 = "";
    var taskName;
    var time;
    var frequency;
    var jarName;
    var testCaseName;
    document.addEventListener('click',(event)=>{
        console.log(event.target['id']);
        
    })
    document.querySelector('#reportPathButton').addEventListener('click', () => {
        dir1 = dialog.showOpenDialog({
            properties: ['openDirectory']

        })

        //   console.log(dir[0]);
        // let content = "cd C:\\Users\\Xmplar\\eclipse-workspace1\\DcfGebFramework && java -jar AlphaV1.jar \"com.xmplar.dcf.testclasses.ConsolidatedCourtCaseUnitTestCase\" \"D:\\pass.txt\"";
        // You can obviously give a direct path without use the dialog (C:/Program Files/path/myfileexample.txt)
        // electron-packager . geb  --platform=win32 --arch=x64 --out=Geb Config --prune=true

        // dir = dir[0]
        // dir = dir.toString()
        // dir = dir.replace(/\\/g, '\\\\')

        console.log(dir1);

        // fileName is a string that contains the path and filename created in the save file dialog.

    });
    document.querySelector('#configPathButton').addEventListener('click', () => {
        dir2 = dialog.showOpenDialog({
            properties: ['openFile']

        })

        //   console.log(dir[0]);
        // let content = "cd C:\\Users\\Xmplar\\eclipse-workspace1\\DcfGebFramework && java -jar AlphaV1.jar \"com.xmplar.dcf.testclasses.ConsolidatedCourtCaseUnitTestCase\" \"D:\\pass.txt\"";
        // You can obviously give a direct path without use the dialog (C:/Program Files/path/myfileexample.txt)
        // electron-packager . geb  --platform=win32 --arch=x64 --out=Geb Config --prune=true

        // dir = dir[0]
        // dir = dir.toString()
        // dir = dir.replace(/\\/g, '\\\\')

        console.log(dir2);

        // fileName is a string that contains the path and filename created in the save file dialog.

    });
    
    function getSchedulerValues(){
        time = document.querySelector('#time').value;
        var e = document.querySelector("#freq");
        frequency = e.options[e.selectedIndex].value;
        jarName = document.querySelector('#jarName').value;
        testCaseName = document.querySelector('#testCaseName').value;
        taskName = document.querySelector('#taskName').value;
    }
   
    /* document.querySelector('#submitConfig').addEventListener('click',function(){
        getConfigValues();
        configBuilder();
        const dialogOptions = { type: 'info', buttons: ['OK', 'Cancel'], message: fileName }
        dialog.showMessageBox(dialogOptions, i => console.log(i))
        window.location.reload();
    }); */
    document.querySelector('#scheduleButton').addEventListener('click', function () {
        // var hash = bcrypt.hashSync(password, saltRounds);
        var fileName1 = null;
        fileName = dialog.showSaveDialog({})
        console.log(fileName);
        
        getSchedulerValues()
        /* var flName = fileName;
        flName = flName.toString();
        flName = flName.replace(/\\/g, '\\\\');
        cont = `cd ${dir} && java -jar ${jarName} ${testCaseName} ${flName}`;
        let arr = fileName.split('\\');
        arr.splice(arr.length -1,1);
        fileName1 = arr.join('\\');
        fileName1 += "\\TestCase.bat"; */
        var flName = dir2;
        flName = flName.toString();
        flName = flName.replace(/\\/g, '\\\\');
        var cont = `cd ${dir1} && java -jar ${jarName} ${testCaseName} ${flName}`;
        writeToFile(fileName, cont);   
        // window.location.reload();  
        const dialogOptions = { type: 'info', buttons: ['OK', 'Cancel'], message: cont }
        const execSync = require('child_process').execSync;
        //schtasks /Create /tn "mytask5" /sc ONCE /st 17:49:00 /tr "C:\Users\Xmplar\Desktop\UnitTestCases.bat"
        code = execSync(`schtasks /Create /tn ${taskName.toString()} /sc ${frequency.toString()} /st ${time.toString()} /tr ${fileName}`);
        dialog.showMessageBox(dialogOptions, i => console.log(i))
        window.location.reload();
    })

</script>

</html>
<!-- 
Important Commands:
Geb>electron-packager . geb  --platform=win32 --arch=x64 --out=Geb Config --prune=truelabels -->

<!-- Runtime.getRuntime().addShutdownHook(new Thread() 
		    { 
		      public void run() 
		      { 
		    	  try {
		  			Thread.sleep(5000);
		  			zipfile();
		  		SendMail(args[1],status,sub);
		  		}catch(Exception e) {
		  			System.out.println("Message"+e.getMessage());
		  			System.out.println(e.getStackTrace());
		  			System.out.println("Failed to send the Email");
		  			System.out.println("Message :"+e.getMessage());
		  			
		  		}
		      } 
		    }); 
		
        System.exit(0); -->
        
        <!-- Runtime.getRuntime().addShutdownHook(new Thread() {
			public void run() {
				try {
					Thread.sleep(5000);
					zipfile();
					SendMail(args[1], status, sub);
				} catch (Exception e) {
					System.out.println("Message" + e.getMessage());
					System.out.println(e.getStackTrace());
					System.out.println("Failed to send the Email");
					System.out.println("Message :" + e.getMessage());

				}
			}
		}); -->